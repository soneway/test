<html>
  <head>
    <title>sw</title>
    <style>
    </style>
  </head>
  <body>
    <div>
      <img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/8/5/16c6119c629ec578~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp" />
    </div>

    <script>
    const { serviceWorker } = navigator;

    window.addEventListener('load', () => {
      // serviceWorker.getRegistration('./sw.js')
      //   .then((registration) => {
      //     registration.unregister();
      //   });

      // 注册 sw
      serviceWorker
        .register('./sw.js')
        .then(
          () => {
            console.log('sw register ok');
          },
          () => {
            console.log('sw register error');
          },
        );
    });

    // 接收来自 sw 的消息
    serviceWorker.addEventListener('message', (event) => {
      console.log('message event', event);
      if (event.data === 'sw.reload') {
        location.reload();
      }
    });

    // 向 sw 发送消息
    serviceWorker.controller.postMessage('html message');

    console.log(4);


    </script>
  </body>
</html>
